<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Serguei Ossokine">

<title>Basics of GIS – The elephant of surprise</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="style.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">The elephant of surprise</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SergeiOssokine"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page">
      <div class="quarto-title-block"><div><h1 class="title">Basics of GIS</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta column-page">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Serguei Ossokine </p>
            </div>
    </div>
      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block column-page" id="quarto-document-content">





<section id="introduction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction</h1>
<p>Cartography - the science of map-making - has been an essential tool for human exploration and understanding for millennia. From ancient Babylonian clay tablets to Ptolemy’s “Geography” to Polynesian Stick Charts (and so many <a href="https://press.uchicago.edu/books/HOC/index.html">others</a>), we’ve always grappled with the challenge of representing our world. As the years drew on, we developed various map projections to represent the curved Earth on a flat surface, although each projection had its own strengths and distortions, which reflect the historical context of the times. With time, navigation became ever more crucial for trade, empire-building and war, and cartography evolved as well, reflecting advancements in mathematics, astronomy, and geodesy.</p>
<p>In our modern globalized world, cartography has taken on new dimensions of importance. Digital mapping technologies, powered by satellite imagery and GPS, have revolutionized how we navigate and understand our planet. Cartography is all around us: from the ubiquitous smartphone maps guiding our daily commutes, to the sophisticated GIS systems informing urban planning and climate science. As we continue to explore our home planet, the solar system, and beyond, mathematical cartography will remain an indispensable tool, helping us to visualize and understand new worlds.</p>
<p>But let’s return to the Earth for the time being. Representing spatial information accurately on the surface of the Earth requires a good mathematical model. In this blog post, let’s examine some basics of modelling the Earth surface, as well as the problem of mapping information from the curved Earth surface to a flat map at a high level.</p>
</section>
<section id="sec-earthmodel" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Spherical and Ellipsoidal Earth</h1>
<p>The simplest mathematical model of the Earth is a sphere. The widely known latitude and longitude furnish standard angular coordinates for the surface, which can be expressed parametrically using the usual expression in Cartesian coordinates <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:</p>
<p><span class="math display">\[
\begin{align}
x &amp;= R\cos\phi\cos\theta \\
y &amp;= R\sin\phi\cos\theta \\
z &amp;= R\sin\theta
\end{align}
\]</span></p>
<p>While the spherical model is remarkably good, modern applications require a more accurate representation. The most important effect to take into account is the (very slight) bulging out of the surface close to the equator, caused by Earth’s rotation. An approptriate model for this is a ellipsoid of revolution (aka a prolate spheroid) which is created by rotating an ellipse around its semiminor axis (which we take to be the <span class="math inline">\(z\)</span> axis). Since we have azimuthal symmetry, it’s easier to examine the properties and parametrization of the spheroid by considering an arbitrary cross-section. Without loss of generality, we work in the <span class="math inline">\(x-z\)</span> plane.</p>
<p>In Cartesian coordinates, the ellipse is given by</p>
<p><span class="math display">\[ \frac{x^2}{a^2}+\frac{z^2}{b^2} = 1 \]</span></p>
<p>The following table summarizes some popular parameterizations. For construction/derivation see <a href="#sec-parametrizations" class="quarto-xref">Section&nbsp;5.1</a></p>
<div class="columns">
<div class="column" style="width:33%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Standard</figcaption>
<p><img src="./ellipse_standard.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<p><span class="math display">\[
\begin{align}
x &amp;= a\cos t \\
z &amp;= b\sin t
\end{align}
\]</span></p>
</div><div class="column" style="width:33%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Polar</figcaption>
<p><img src="./ellipse_polar.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<p><span class="math display">\[
\begin{align}
x &amp;= r(\theta)\cos \theta \\
z &amp;= r(\theta)\sin \theta
\end{align}
\]</span></p>
</div><div class="column" style="width:33%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Geodetic</figcaption>
<p><img src="./ellipse_geodetic.svg" class="img-fluid figure-img"></p>
</figure>
</div>
<p><span class="math display">\[
\begin{align}
x &amp;= N(\phi)\cos\phi \\
z &amp;= \frac{b^{2}}{a^2}N(\phi)\sin\phi
\end{align}
\]</span></p>
</div>
</div>
<p>To parametrize the ellipsoid, we just need to rotate the ellipse around the <span class="math inline">\(z\)</span> axis and pay attention to limits of the angles. Defining the usual azimuthal angle by <span class="math inline">\(\lambda\)</span> for the geodetic parametrization we get</p>
<p><span class="math display">\[ (x,y,z) = (N(\phi)\cos\phi\cos\lambda,N(\phi)\cos\phi\sin\lambda,\frac{b^2}{a^2}N(\phi)\sin\phi) \]</span></p>
<p>with <span class="math inline">\(\lambda \in (0,2\pi)\)</span> and <span class="math inline">\(\phi \in (-\pi/2,\pi/2)\)</span>.</p>
<p>An important parameter while frequently encountered in descriping ellipsoid is the <em>flattening</em> which is equal to</p>
<p><span class="math display">\[ f = 1-\frac{b}{a} \]</span></p>
<p>It describes the degree of “squashing” of the spheroid - the deviation of being a perfect sphere. Remarkably, for the Earth this flattening is extremely small (<span class="math inline">\(\sim 1/298.26\)</span>) <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, corrsesponding to a difference of just <span class="math inline">\(\sim 21\)</span> km between the polar and equatorial axes.</p>
<section id="building-geographic-coordinate-systems-gcs-geoid-datum-and-friends" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="building-geographic-coordinate-systems-gcs-geoid-datum-and-friends"><span class="header-section-number">3.1</span> Building Geographic Coordinate Systems (GCS): geoid, datum and friends</h2>
<section id="the-geoid" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="the-geoid"><span class="header-section-number">3.1.1</span> The geoid</h3>
<p>The actual shape of the Earth is extremely complex and can only be determined via measurement. Indeed the complicated surface topology of the land masses is very difficult to model mathematically. Instead, one can define some reference surfaces.</p>
<p>A particularly important surface is the <em>geoid</em> which is defined as the shape the Earth’s oceans would take under the influence of gravity and centrifugal forces, if we turned off all other interactions like tides and currents. In such a case, the surface of the oceans would be an equipotential surface of the potential (expressed in the co-rotating frame)<span class="citation" data-cites="barthelm2013">(<a href="#ref-barthelm2013" role="doc-biblioref">Barthelm 2013</a>)</span>:</p>
<p><span class="math display">\[ W = W_{a}+\Phi_{c}\]</span></p>
<p>where <span class="math inline">\(W_{a}(\vec{r})\equiv G\int_{v}\frac{\rho(\vec{r'})}{|\vec{r}-\vec{r'}|}dV\)</span> is the Newtonian gravitational potential and <span class="math inline">\(\Phi_{c}\equiv \frac{1}{2}\Omega^{2}d_{z}^{2}\)</span> is the centrifugal potential. That is, the geoid is defined as a particular <span class="math inline">\(W = \rm{const}\)</span> surface.</p>
<p>It should be noted that the geoid is a very complicated surface as the potential <span class="math inline">\(W\)</span> depends on the non-uniform mass density distribution inside the Earth. The measurement of the Earth’s potential has been carried out by multiple satellite missions and variations have now been mapped to scales of about 10 km. Below is an example of geoid modulations from the XGM2019e model<span class="citation" data-cites="Zingerle2020">(<a href="#ref-Zingerle2020" role="doc-biblioref">Zingerle et al. 2020</a>)</span> (the modulations have been exaggerated be a factor of 10000):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Image generated using the visualization software <a href="https://icgem.gfz-potsdam.de/vis3d/longtime">here</a></figcaption>
<p><a href="./geoid_XGM2019e.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Image generated using the visualization software here"><img src="./geoid_XGM2019e.jpeg" class="img-fluid figure-img" style="width:50.0%" alt="Image generated using the visualization software here"></a></p>
</figure>
</div>
</section>
<section id="the-geodetic-datum" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="the-geodetic-datum"><span class="header-section-number">3.1.2</span> The geodetic datum</h3>
<p>Given a model of the geoid, a natual question arises of how to align a spheroidal model of the Earth to “best” represent it. One obvious choice is to align the ellipsoid so that it approximates the shape of the geoid in the least-squares sense for the entire globe, forming a so called <em>geocentric</em> datum. We then map the Earth’s surface features onto the aligned ellipsoid. A very widely used example of this is the WGS84 datum, which is the standard datum used in most GPS systems. Another possibility is to try to approximate the geoid as well as possible in particular region. Such datums are known as <em>local</em> datums. For example, the NAD83 (North American Datum 83) datum is particularly well suited for representing the US but is less well suited for Europe. Since a datum is a <em>reference</em> surface that determines the geographic coordinate system, it is important to always keep in mind which datum is being used, especially when combining data from different sources.</p>
</section>
</section>
</section>
<section id="maps-from-earth-to-paper" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Maps: from Earth to paper</h1>
<section id="background" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="background"><span class="header-section-number">4.1</span> Background</h2>
<p>One of the most famous results in classical differential geometry due to Carl Friedrich Gauss is the <em>Theorema Egregium</em> (remarkable theorem) which states that Gaussian curvature of a given surface (a certain measure of curvature) can be determined by measurements <em>intrinsic</em> to the surface, without any reference to how it is embedded in ambient space. The connection the mapping problem is the following: a sphere (or an ellipsoid) has non-zero Gaussian curvature while a piece of paper has vanishing Gaussian curvature. Thus it follows that a piece of paper cannot be folded into a sphere or conversely that a surface of a sphere cannot be unfolded onto a flat piece of paper without distortion. We therefore should expect that there is no way to construct a flat map that reproduces the information on the surface of the Earth without some distortion.</p>
<p>One approach that is very frequently presented when developing projections is by the use of the so-called developable surfaces. For our purposes here, a <em>developable</em> surface is simply a surface that has zero Gaussian curvature and thus can be unrolled into a flat plane without bending (i.e.&nbsp;without distortions). In 3D, there are only a few such surfaces which are of use: cylinders, cones and (trivially) planes. The idea is then to project the surface of the Earth onto the developable surface and then to unroll that surface into a flat map.</p>
<p>Based on the type of developable surface one can classify many projections<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 20%">
<col style="width: 28%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Normal</th>
<th>Transverse</th>
<th>Oblique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Azimuthal</strong></td>
<td><img src="./azimuthal_normal.png" class="img-fluid" width="200"></td>
<td><img src="./azimuthal_transverse.png" class="img-fluid" width="200"></td>
<td><img src="./azimuthal_oblique.png" class="img-fluid" width="200"></td>
</tr>
<tr class="even">
<td><strong>Cylindrical</strong></td>
<td><img src="./cylindrical_normal.png" class="img-fluid" width="200"></td>
<td><img src="./cylindrical_transverse.png" class="img-fluid" width="200"></td>
<td><img src="./cylindrical_oblique.png" class="img-fluid" width="200"></td>
</tr>
<tr class="odd">
<td><strong>Conical</strong></td>
<td><img src="./conical_normal.png" class="img-fluid" width="200"></td>
<td><img src="./conical_transverse.png" class="img-fluid" width="200"></td>
<td><img src="./conical_oblique.png" class="img-fluid" width="200"></td>
</tr>
</tbody>
</table>
<p>In the above we only considered the cases where the developable surfaces touch the sphere. One can also consider <em>secant</em> variations where the developable surfaces intersect the sphere in multiple locations. This is demonstrated for the case of the conical map in the following video:</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/VyNd4fLsPwo" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Note that there are many modern projections which cannnot be classified in any of the above categories. For this and other reasons some authors have criticised this classical classification scheme<span class="citation" data-cites="geographies2020019">(<a href="#ref-geographies2020019" role="doc-biblioref">Lapaine and Frančula 2022</a>)</span>. Indeed, <em>modern</em> projections do not need developable surfaces to be defined and are derived by considering desirable properties of the mapping.</p>
<section id="to-be-continued" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="to-be-continued"><span class="header-section-number">4.1.1</span> To be continued</h3>
<p>In the next post we will present a modern way of classifying and deriving projections, based on the notion of certain desirable properties (such as preserving angles) and derive a couple of famous projections from scrach. Stay tuned!</p>
</section>
</section>
</section>
<section id="appendix" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Appendix</h1>
<section id="sec-parametrizations" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-parametrizations"><span class="header-section-number">5.1</span> Ellipse parametrizations</h2>
<section id="standard-aka-de-la-hire" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="standard-aka-de-la-hire"><span class="header-section-number">5.1.1</span> Standard (aka de la Hire)</h3>
<p>A simple parametrization in terms of angles is given by <span class="math inline">\((a\cos t,a\sin t)\)</span>. Note, however, that here <span class="math inline">\(t\)</span> is <strong>not</strong> the angle between the semi-major axis and the point on the spheroid (see figure below). Indeed, the construction is done as follows:</p>
<ul>
<li>Draw 2 circles centered at (0,0) with radii <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span></li>
<li>Given any point <span class="math inline">\(P\)</span> on the ellipse draw a vertical line from <span class="math inline">\(P\)</span> until it intersects the larger circle with radius <span class="math inline">\(a\)</span> and a horizontal line that intersects with circle of radius <span class="math inline">\(b\)</span>. Note that there is a unique line from the origin that passes through both interesection points.</li>
<li>The angle between the semi-major axis and this line is denoted <span class="math inline">\(t\)</span>. From trigonometric considerations it follows immediately that the Cartesian coordinates of <span class="math inline">\(P\)</span> are indeed <span class="math inline">\((a\cos t,a\sin t)\)</span></li>
</ul>
</section>
<section id="polar" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="polar"><span class="header-section-number">5.1.2</span> Polar</h3>
<p>Another simple parametrization is the polar one, given by <span class="math inline">\((r(\theta)\cos\theta,r(\theta)\sin\theta)\)</span>. To find <span class="math inline">\(r(\theta)\)</span>, note that the point must lie on the ellipse and thus:</p>
<p><span class="math display">\[ \frac{r^2\cos^2\theta}{a^2} + \frac{r^2\sin^2\theta}{b^2} = 1 \]</span> From which it follows that</p>
<p><span class="math display">\[ r(\theta) = \frac{ab}{\sqrt{b^2\cos^2\theta+a^2\sin^2\theta}} \]</span></p>
</section>
<section id="geodetic" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="geodetic"><span class="header-section-number">5.1.3</span> Geodetic</h3>
<p>Finally, for GIS applications a particularly important parametrization is one involving the so-called geodetic lattitude (<span class="math inline">\(\phi\)</span>) which is the angle between the semi-major axis and the normal to the ellipse. Note that unlike the case of a circle, the normal does <em>not</em> generally pass through the center of the ellipse. To derive this parametrization we will proceed as follows. Consider the normal to the ellipse at some point <span class="math inline">\(P=(x_0,z_0)\)</span>. Let <span class="math inline">\(f(x,z)=\frac{x^2}{a^2}+\frac{z^2}{b^2}\)</span>. Then the ellipse is the level set of <span class="math inline">\(f\)</span>, given by <span class="math inline">\(f(x,z)=1\)</span>. A well known result is that the gradient of the function is normal to the level sets <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. Thus <span class="math inline">\(\nabla f\)</span> is a vector in the direction of the normal. We have</p>
<p><span class="math display">\[ \nabla f = (f_x,f_z) =  \left(\frac{2x}{a^2},\frac{2z}{b^2}\right) \]</span></p>
<p>From trigonometry we have that</p>
<p><span class="math display">\[ \tan\phi = \frac{f_z}{f_x}\rvert_{(x_0,z_0)} = \frac{a^2}{b^2}\frac{z_0}{x_0} \]</span></p>
<p>which implies that <span class="math inline">\(z_0^2 = \frac{b^4}{a^4}x_0^2\tan^2\phi\)</span>. Since <span class="math inline">\(P\)</span> lies on the ellipse we also have that</p>
<p><span class="math display">\[ b^2 x_0^2 + a^2 z_0^2 = a^2 b^2\]</span></p>
<p>Substituting we get that</p>
<p><span class="math display">\[ x_0^{2} = \frac{a^{4}}{a^2+b^2\tan\phi} = \frac{a^4\cos^2\phi}{a^2\cos^2\phi+b^2\sin^2\phi} \]</span></p>
<p>which means</p>
<p><span class="math display">\[ x_0 =  \frac{a^2}{\sqrt{a^2\cos^2\phi+b^2\sin^2\phi}}\cos\phi  := N(\phi)\cos\phi \]</span></p>
<p>(Note that we took the positive root since we want <span class="math inline">\(x\geq 0\)</span> for <span class="math inline">\(\phi\in[0,\pi/2]\)</span> )</p>
<p>Substituting this result back and solving for <span class="math inline">\(z_0\)</span> we get</p>
<p><span class="math display">\[ z_0 = \frac{b^2}{a^2}N(\phi)\sin\phi\]</span></p>
<p>Thus we finally have that the parametrization of the ellipse is given by</p>
<p><span class="math display">\[ \left(N(\phi)\cos\phi,\frac{b^2}{a^2}N(\phi)\sin\phi\right) \]</span></p>
<p>One can easily check that:</p>
<ul>
<li>The coordinates do indeed describe an ellipse</li>
<li>One gets the expected coordinates for <span class="math inline">\(\phi=0\)</span> and <span class="math inline">\(\phi=\pi/2\)</span>.</li>
</ul>
<p>The 2D figures in <a href="#sec-earthmodel" class="quarto-xref">Section&nbsp;3</a> were created using <a href="https://asymptote.sourceforge.io/">Asymptote Vector Graphics Language</a>. The code can be found <a href="https://github.com/SergeiOssokine/gis_exploration/tree/master/gis_part1/ellipse_plots">here</a></p>


<!-- -->


</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-barthelm2013" class="csl-entry" role="listitem">
Barthelm, Franz. 2013. <span>“Definition of Functionals of the Geopotential and Their Calculation from Spherical Harmonic Models.”</span> International Centre for Global Earth Models. <a href="https://icgem.gfz-potsdam.de/docs/str-0902-revised.pdf">https://icgem.gfz-potsdam.de/docs/str-0902-revised.pdf</a>.
</div>
<div id="ref-geographies2020019" class="csl-entry" role="listitem">
Lapaine, Miljenko, and Nedjeljko Frančula. 2022. <span>“Map Projections Classification.”</span> <em>Geographies</em> 2 (2): 274–85. <a href="https://doi.org/10.3390/geographies2020019">https://doi.org/10.3390/geographies2020019</a>.
</div>
<div id="ref-leesmooth" class="csl-entry" role="listitem">
Lee, John M. 2003. <em>Introduction to Smooth Manifolds</em>. Springer.
</div>
<div id="ref-Zingerle2020" class="csl-entry" role="listitem">
Zingerle, P., R. Pail, T. Gruber, and X. Oikonomidou. 2020. <span>“<span class="nocase">The combined global gravity field model XGM2019e</span>.”</span> <em>Journal of Geodesy</em> 94 (7): 66. <a href="https://doi.org/10.1007/s00190-020-01398-0">https://doi.org/10.1007/s00190-020-01398-0</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In principle this is not quite correct - there is no single coordinate chart that can cover the whole sphere. Indeed the polar coordinates do not cover the poles (the intervals for the angles must be <em>open</em>). See e.g.&nbsp;Example 4.1.4 in <span class="citation" data-cites="leesmooth">(<a href="#ref-leesmooth" role="doc-biblioref">Lee 2003</a>)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The data can be found in many sources, e.g.&nbsp;In Table 1.1. of <a href="https://www.iers.org/IERS/EN/Publications/TechnicalNotes/tn36.html">this report</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>You can find the code to generate these figures <a href="https://github.com/SergeiOssokine/gis_exploration/tree/master/gis_part1/projection_figures">here</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>See e.g.&nbsp;<a href="https://ocw.mit.edu/courses/18-02sc-multivariable-calculus-fall-2010/85c1d85363d9808505351b571d2750aa_MIT18_02SC_notes_19.pdf">here</a> for a proof in <span class="math inline">\(\mathbb{R}^3\)</span>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Basics of GIS"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Serguei Ossokine"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    html:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">        theme: cosmo</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">        page-layout: full</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">        css: style.css</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">        code-tools: true</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">        code-summary: "Show the code"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">        number-sections: true</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">        number-offset: 1</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">        fig-cap-location: top</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> ./articles.bib</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="an">custom-numbered-blocks:</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">  groups:</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">    thmlike:</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">      colors: [948bde, 584eab]</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">      boxstyle: foldbox.simple</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">      collapse: false</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">      listin: [mathstuff]</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">    todos: default</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">  classes:</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">    Theorem:</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">      group: thmlike</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">    Corollary:</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">      group: thmlike</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">    Conjecture:</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">      group: thmlike</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">      collapse: true</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">    Proposition:</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">      group: thmlike</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">      colors: [d999d3, a01793]</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">      numbered: false</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">    Feature: default</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">    TODO:</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">      label: "To do"</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">      colors: [e7b1b4, 8c3236]</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">      group: todos</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">      listin: [stilltodo]</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">    DONE:</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="co">      label: "Done"</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co">      colors: [cce7b1, 86b754]</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">      group: todos</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">    Proof:</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co">      numbered: false</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>Cartography - the science of map-making - has been an essential tool for human exploration and understanding for millennia. From ancient Babylonian clay tablets to Ptolemy's "Geography" to Polynesian Stick Charts (and so many <span class="co">[</span><span class="ot">others</span><span class="co">](https://press.uchicago.edu/books/HOC/index.html)</span>), we've always grappled with the challenge of representing our world. As the years drew on, we developed  various map projections to represent the curved Earth on a flat surface, although each projection had its own strengths and distortions, which reflect the historical context of the times. With time, navigation became ever more crucial for trade, empire-building and war, and cartography evolved as well, reflecting advancements in mathematics, astronomy, and geodesy.</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>In our modern globalized world, cartography has taken on new dimensions of importance. Digital mapping technologies, powered by satellite imagery and GPS, have revolutionized how we navigate and understand our planet. Cartography is all around us: from the ubiquitous smartphone maps guiding our daily commutes, to the sophisticated GIS systems informing urban planning and climate science. As we continue to explore our home planet, the solar system, and beyond, mathematical cartography will remain an indispensable tool, helping us to visualize and understand new worlds.</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>But let's return to the Earth for the time being. Representing spatial information accurately on the surface of the Earth requires a good mathematical model. In this blog post, let's examine some basics of modelling the Earth surface, as well as the problem of mapping information from the curved Earth surface to a flat map at a high level.</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="fu"># Spherical and Ellipsoidal Earth  {#sec-earthmodel}</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>The simplest mathematical model of the Earth is a sphere. The widely known latitude and longitude furnish standard angular coordinates for the surface, which can be expressed parametrically using the usual expression in Cartesian coordinates <span class="ot">[^1]</span>:</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>x &amp;= R\cos\phi\cos\theta <span class="sc">\\</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>y &amp;= R\sin\phi\cos\theta <span class="sc">\\</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>z &amp;= R\sin\theta</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>While the spherical model is remarkably good, modern applications require a more accurate representation. The most important effect to take into account is the (very slight) bulging out of the surface close to the equator, caused by Earth's rotation.  An approptriate model for this is a ellipsoid of revolution (aka a prolate spheroid) which is created by rotating an ellipse around its semiminor axis (which we take to be the $z$ axis). Since we have azimuthal symmetry, it's easier to examine the properties and parametrization of the spheroid by considering an arbitrary cross-section. Without loss of generality, we work in the $x-z$ plane.</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>In Cartesian coordinates, the ellipse is given by</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>$$ \frac{x^2}{a^2}+\frac{z^2}{b^2} = 1 $$</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>The following table summarizes some popular parameterizations. For construction/derivation see @sec-parametrizations</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>:::: {.columns}</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>::: {.column width="33%"}</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="al">![Standard](./ellipse_standard.svg)</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>x &amp;= a\cos t <span class="sc">\\</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>z &amp;= b\sin t</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>::: {.column width="33%"}</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a><span class="al">![Polar](./ellipse_polar.svg)</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>x &amp;= r(\theta)\cos \theta <span class="sc">\\</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>z &amp;= r(\theta)\sin \theta</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>::: {.column width="33%"}</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="al">![Geodetic](./ellipse_geodetic.svg)</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>x &amp;= N(\phi)\cos\phi <span class="sc">\\</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>z &amp;= \frac{b^{2}}{a^2}N(\phi)\sin\phi</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>To parametrize the ellipsoid, we just need to rotate the ellipse around the $z$ axis and pay attention to limits of the angles.</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>Defining the usual azimuthal angle by $\lambda$ for the geodetic parametrization we get</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>$$ (x,y,z) = (N(\phi)\cos\phi\cos\lambda,N(\phi)\cos\phi\sin\lambda,\frac{b^2}{a^2}N(\phi)\sin\phi) $$</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>with $\lambda \in (0,2\pi)$ and $\phi \in (-\pi/2,\pi/2)$.</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>An important parameter while frequently encountered in descriping ellipsoid is the _flattening_ which is equal to</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>$$ f = 1-\frac{b}{a} $$</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>It describes the degree of "squashing" of the spheroid - the deviation of being a perfect sphere. Remarkably, for the Earth this flattening is extremely small ($\sim 1/298.26$) <span class="ot">[^2]</span>, corrsesponding to a difference of just $\sim 21$ km between the polar and equatorial axes.</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="fu">## Building Geographic Coordinate Systems (GCS): geoid, datum and friends</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="fu">### The geoid</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>The actual shape of the Earth is extremely complex and can only be determined via measurement.  Indeed the complicated surface topology of the land masses is very difficult to model mathematically. Instead, one can define some reference surfaces.</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>A particularly important surface is the _geoid_ which is defined as the shape the Earth's oceans would take under the influence of gravity and centrifugal forces, if we turned off all other interactions like tides and currents. In such a case, the surface of the oceans would be an equipotential surface of the potential (expressed in the co-rotating frame)<span class="co">[</span><span class="ot">@barthelm2013</span><span class="co">]</span>:</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>$$ W = W_{a}+\Phi_{c}$$</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>where $W_{a}(\vec{r})\equiv G\int_{v}\frac{\rho(\vec{r'})}{|\vec{r}-\vec{r'}|}dV$ is the Newtonian gravitational potential and $\Phi_{c}\equiv \frac{1}{2}\Omega^{2}d_{z}^{2}$ is the centrifugal potential.  That is, the geoid is defined as a particular $W = \rm{const}$ surface.</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>It should be noted that the geoid is a very complicated surface as the potential $W$ depends on the non-uniform mass density distribution inside the Earth.   The measurement of the Earth's potential has been carried out by multiple satellite missions and variations have now been mapped to scales of about 10 km. Below is an example of  geoid modulations from the XGM2019e model<span class="co">[</span><span class="ot">@Zingerle2020</span><span class="co">]</span> (the modulations have been exaggerated be a factor of 10000):</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">Image generated using the visualization software [here](https://icgem.gfz-potsdam.de/vis3d/longtime)</span><span class="co">](./geoid_XGM2019e.jpeg)</span>{.lightbox width=50%}</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### The geodetic datum</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>Given a model of the geoid, a natual question arises of how to align a spheroidal model of the Earth to "best" represent it. One obvious choice is to align the ellipsoid so that it approximates the shape of the geoid in the least-squares sense for the entire globe, forming a so called _geocentric_ datum. We then map the Earth's surface features onto the aligned ellipsoid.   A very widely used example of this is the WGS84 datum, which is the standard datum used in most GPS systems. Another possibility is to try to approximate the geoid as well as possible in particular region. Such datums are known as _local_ datums. For example, the NAD83 (North American Datum 83) datum is particularly well suited for representing the US but is less well suited for Europe. Since a datum is a _reference_ surface  that determines the geographic coordinate system, it is important to always keep in mind which datum is being used, especially when combining data from different sources.</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a><span class="fu"># Maps: from Earth to paper</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>One of the most famous results in classical differential geometry due to Carl Friedrich Gauss is the _Theorema Egregium_ (remarkable theorem) which states that Gaussian curvature of a given surface (a certain measure of curvature) can be determined by measurements _intrinsic_ to the surface, without any reference to how it is embedded in ambient space.  The connection the mapping problem is the following: a sphere (or an ellipsoid) has non-zero Gaussian curvature while a piece of paper has vanishing Gaussian curvature. Thus it follows that a piece of paper cannot be folded into a sphere or conversely that a surface of a sphere cannot be unfolded onto a flat piece of paper without distortion. We therefore should expect that there is no way to construct a flat map that reproduces the information on the surface of the Earth without some distortion.</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>One approach that is very frequently presented when developing projections is by the use of the so-called developable surfaces. For our purposes here, a _developable_ surface is simply a surface that has zero Gaussian curvature and thus can be unrolled into a flat plane without bending (i.e. without distortions). In 3D, there are only a few such surfaces which are of use: cylinders, cones and (trivially) planes. The idea is then to project the surface of the Earth onto the developable surface and then to unroll that surface into a flat map.</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>Based on the type of developable surface one can classify many projections<span class="ot">[^3]</span>:</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>|            | Normal      | Transverse         | Oblique             |</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>|------------|--------------|-------------------|----------------------|</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>| **Azimuthal**  |  <span class="al">![](./azimuthal_normal.png)</span>{width=200px}             |   <span class="al">![](./azimuthal_transverse.png)</span>{width=200px}               | <span class="al">![](./azimuthal_oblique.png)</span>{width=200px}                 |</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>| **Cylindrical**|  <span class="al">![](./cylindrical_normal.png)</span>{width=200px}             |   <span class="al">![](./cylindrical_transverse.png)</span>{width=200px}               | <span class="al">![](./cylindrical_oblique.png)</span>{width=200px}                 |</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>| **Conical**    |  <span class="al">![](./conical_normal.png)</span>{width=200px}            |   <span class="al">![](./conical_transverse.png)</span>{width=200px}               | <span class="al">![](./conical_oblique.png)</span>{width=200px}                 |</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>In the above we only considered the cases where the developable surfaces touch the sphere. One can also consider _secant_ variations where the developable surfaces intersect the sphere in multiple locations. This is demonstrated for the case of the conical map in the following video:</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/VyNd4fLsPwo &gt;}}</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>Note that there are many modern projections which cannnot be classified in any of the above categories. For this and other reasons some authors have criticised this classical classification scheme<span class="co">[</span><span class="ot">@geographies2020019</span><span class="co">]</span>. Indeed, _modern_ projections do not need developable surfaces to be defined and are derived by considering desirable properties of the mapping.</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a><span class="fu">### To be continued</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>In the next post we will present a modern way of classifying and deriving projections, based on the notion of certain desirable properties (such as preserving angles) and derive a couple of famous projections from scrach.  Stay tuned!</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendix</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ellipse parametrizations {#sec-parametrizations}</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a><span class="fu">### Standard (aka de la Hire)</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>A simple parametrization in terms of angles is given by $(a\cos t,a\sin t)$. Note, however, that here $t$ is **not** the angle between the semi-major axis and the point on the spheroid (see figure below). Indeed, the construction is done as follows:</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Draw 2 circles centered at (0,0) with radii $a$ and $b$</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Given any point $P$ on the ellipse draw a vertical line from $P$ until it intersects the larger circle with radius $a$ and a horizontal line that intersects with circle of radius $b$. Note that there is a unique line from the origin that passes through both interesection points.</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The angle between the semi-major axis and this line is denoted $t$. From trigonometric considerations it follows immediately that the Cartesian coordinates of $P$ are indeed  $(a\cos t,a\sin t)$</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a><span class="fu">### Polar</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>Another simple parametrization is the polar one, given by $(r(\theta)\cos\theta,r(\theta)\sin\theta)$. To find $r(\theta)$, note that the point must lie on the ellipse and thus:</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>$$ \frac{r^2\cos^2\theta}{a^2} + \frac{r^2\sin^2\theta}{b^2} = 1 $$</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>From which it follows that</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>$$ r(\theta) = \frac{ab}{\sqrt{b^2\cos^2\theta+a^2\sin^2\theta}} $$</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Geodetic</span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>Finally, for GIS applications a particularly important parametrization is one involving the so-called geodetic lattitude ($\phi$) which is the angle between the semi-major axis and the normal to the ellipse. Note that unlike the case of a circle, the normal does _not_ generally pass through the center of the ellipse. To derive this parametrization  we will proceed as follows. Consider the normal to the ellipse at some point $P=(x_0,z_0)$.  Let $f(x,z)=\frac{x^2}{a^2}+\frac{z^2}{b^2}$. Then the ellipse is the level set of $f$, given by $f(x,z)=1$. A well known result is that the gradient of the function is normal to the level sets <span class="ot">[^4]</span>. Thus $\nabla f$ is a vector in the direction of the normal. We have</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>$$ \nabla f = (f_x,f_z) =  \left(\frac{2x}{a^2},\frac{2z}{b^2}\right) $$</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>From trigonometry we have that</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>$$ \tan\phi = \frac{f_z}{f_x}\rvert_{(x_0,z_0)} = \frac{a^2}{b^2}\frac{z_0}{x_0} $$</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>which implies that $z_0^2 = \frac{b^4}{a^4}x_0^2\tan^2\phi$. Since $P$ lies on the ellipse we also have that</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>$$ b^2 x_0^2 + a^2 z_0^2 = a^2 b^2$$</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>Substituting we get that</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>$$ x_0^{2} = \frac{a^{4}}{a^2+b^2\tan\phi} = \frac{a^4\cos^2\phi}{a^2\cos^2\phi+b^2\sin^2\phi} $$</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>which means</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>$$ x_0 =  \frac{a^2}{\sqrt{a^2\cos^2\phi+b^2\sin^2\phi}}\cos\phi  := N(\phi)\cos\phi $$</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>(Note that we took the positive root since we want $x\geq 0$  for $\phi\in<span class="co">[</span><span class="ot">0,\pi/2</span><span class="co">]</span>$ )</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>Substituting this result back and solving for $z_0$ we get</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>$$ z_0 = \frac{b^2}{a^2}N(\phi)\sin\phi$$</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>Thus we finally have that the parametrization of the ellipse is given by</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>$$ \left(N(\phi)\cos\phi,\frac{b^2}{a^2}N(\phi)\sin\phi\right) $$</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>One can easily check that:</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The coordinates do indeed describe an ellipse</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>One gets the expected coordinates for $\phi=0$ and $\phi=\pi/2$.</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>The 2D figures in @sec-earthmodel were created using <span class="co">[</span><span class="ot">Asymptote Vector Graphics Language</span><span class="co">](https://asymptote.sourceforge.io/)</span>. The code can be found <span class="co">[</span><span class="ot">here</span><span class="co">](https://github.com/SergeiOssokine/gis_exploration/tree/master/gis_part1/ellipse_plots)</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>In principle this is not quite  correct - there is no single coordinate chart that can cover the whole sphere. Indeed the polar coordinates do not cover the poles (the intervals for the angles must be _open_). See e.g. Example 4.1.4 in  <span class="co">[</span><span class="ot">@leesmooth</span><span class="co">]</span>.</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>The data can be found in many sources, e.g. In Table 1.1. of <span class="co">[</span><span class="ot">this report</span><span class="co">](https://www.iers.org/IERS/EN/Publications/TechnicalNotes/tn36.html)</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>You can find the code to generate these figures <span class="co">[</span><span class="ot">here</span><span class="co">](https://github.com/SergeiOssokine/gis_exploration/tree/master/gis_part1/projection_figures)</span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span>See e.g. <span class="co">[</span><span class="ot">here</span><span class="co">](https://ocw.mit.edu/courses/18-02sc-multivariable-calculus-fall-2010/85c1d85363d9808505351b571d2750aa_MIT18_02SC_notes_19.pdf)</span> for a proof in $\mathbb{R}^3$.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","loop":false,"openEffect":"zoom","closeEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>